(function(){"use strict";var a=angular.module("imgurUploader",["imgurUploader.util"]);a.provider("imgur",function(){var a;this.$get=["$http","$log","$q","fileReaderUtil",function(b,c,d,e){a?c.debug("[imgur] Using Client ID: "+a):c.error("[imgur] No Client ID configured!");var f=function(d,e,f){return c.debug("[imgur] Uploading image (title: "+e+")"),b.post("https://api.imgur.com/3/image",{image:d,title:e,type:f},{headers:{Authorization:"Client-ID "+a,Accept:"application/json"}})},g=function(a,b){return e.readBase64Str(a).then(function(a){return f(a,b,"base64")})};return{upload:f,uploadBase64:g}}],this.setClientId=function(b){a=b}}),a.directive("imgurUploaderFileInput",function(){return{restrict:"EA",scope:{inputClass:"@",uploaderConfig:"="},controller:["$scope","imgur",function(a,b){a.submit=function(c){return b.uploadBase64(a.getFile(),c)}}],link:function(a,b){a.getFile=function(){return b.find("input")[0].files&&b.find("input")[0].files[0]},a.uploaderConfig.onReady&&"function"==typeof a.uploaderConfig.onReady&&a.uploaderConfig.onReady({getFile:a.getFile,submit:a.submit})},template:'<input type="file" ng-class="inputClass">'}}),a.directive("imgurUploaderForm",function(){return{restrict:"EA",scope:{formClass:"@",inputClass:"@",inputContainerClass:"@",submitClass:"@",descriptionLabel:"@",imageLabel:"@",submitLabel:"@",onSubmit:"&"},controller:["$scope","imgur",function(a,b){a.formClass=a.formClass||"",a.inputClass=a.inputClass||"",a.inputContainerClass=a.inputContainerClass||"",a.descriptionLabel=angular.isDefined(a.descriptionLabel)?a.descriptionLabel:"Description",a.imageLabel=angular.isDefined(a.imageLabel)?a.imageLabel:"Image",a.submitLabel=a.submitLabel||"Upload",a.form={description:""},a.uploaderConfig={onReady:function(b){a.uploaderApi=b}},a.upload=function(){if(a.uploaderApi&&a.uploaderApi.getFile()){var b=a.uploaderApi.submit(a.form.description);a.onSubmit&&a.onSubmit({uploadPromise:b})}}}],template:'<form ng-class="formClass"><div ng-class="inputContainerClass"><label>{{descriptionLabel}}</label><input type="text" ng-model="form.description" ng-class="inputClass"></div><div ng-class="inputContainerClass"><label>{{imageLabel}}</label><imgur-uploader-file-input input-class="{{inputClass}}" uploader-config="uploaderConfig"></imgur-uploader-file-input></div><button ng-class="submitClass" ng-click="upload()">{{submitLabel}}</button></form>'}})})(),function(){"use strict";var a=angular.module("imgurUploader.util",[]),b=function(a){for(var b="",c=new Uint8Array(a),d=0;d<c.byteLength;++d)b+=String.fromCharCode(c[d]);return btoa(b)};a.service("fileReaderUtil",["$log","$q",function(a,c){this.readBase64Str=function(d){var e=c.defer(),f=new FileReader;return f.addEventListener("load",function(){var c=f.result;a.debug("[imgur] converting file to base-64...");var d=b(c);e.resolve(d)}),f.addEventListener("error",function(){e.reject()}),a.debug("[imgur] reading file..."),f.readAsArrayBuffer(d),e.promise}}])}();
//# sourceMappingURL=imgur-uploader.min.js.map